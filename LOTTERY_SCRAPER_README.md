# å°æ¹¾å®¾æœå¼€å¥–æ•°æ®æŠ“å–å·¥å…·

è¿™æ˜¯ä¸€ä¸ªç”¨äºæŠ“å–å°æ¹¾å®¾æœå¼€å¥–æ•°æ®çš„å·¥å…·é›†ï¼ŒåŒ…å«æ•°æ®æŠ“å–ã€å®šæ—¶è°ƒåº¦å’ŒAPIæ¥å£åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **æ•°æ®æŠ“å–**: ä»å®˜æ–¹ç½‘ç«™æŠ“å–æœ€æ–°å¼€å¥–æ•°æ®
- â° **å®šæ—¶è°ƒåº¦**: æ”¯æŒå®šæ—¶è‡ªåŠ¨æŠ“å–æ•°æ®
- ğŸ“Š **æ•°æ®å­˜å‚¨**: è‡ªåŠ¨ä¿å­˜å†å²å¼€å¥–è®°å½•
- ğŸ”Œ **APIæ¥å£**: æä¾›RESTful APIè·å–æ•°æ®
- ğŸ“± **è·¨å¹³å°**: æ”¯æŒWindowsã€macOSã€Linux

## å®‰è£…ä¾èµ–

```bash
npm install puppeteer
```

## ä½¿ç”¨æ–¹æ³•

### 1. å•æ¬¡æ•°æ®æŠ“å–

```bash
# æŠ“å–ä¸€æ¬¡æœ€æ–°å¼€å¥–æ•°æ®
npm run scrape

# æˆ–è€…ç›´æ¥è¿è¡Œ
node lottery_scraper.js
```

### 2. å®šæ—¶æ•°æ®æŠ“å–

```bash
# æ¯5åˆ†é’ŸæŠ“å–ä¸€æ¬¡ï¼ˆé»˜è®¤ï¼‰
npm run schedule

# æ¯5åˆ†é’ŸæŠ“å–ä¸€æ¬¡
npm run schedule-5min

# æ¯10åˆ†é’ŸæŠ“å–ä¸€æ¬¡
npm run schedule-10min

# è‡ªå®šä¹‰é—´éš”ï¼ˆåˆ†é’Ÿï¼‰
node scheduler.js 3
```

### 3. APIæ¥å£ä½¿ç”¨

æ•°æ®æŠ“å–åï¼Œå¯ä»¥é€šè¿‡APIæ¥å£è·å–æ•°æ®ï¼š

```bash
# è·å–æœ€æ–°ä¸€æœŸæ•°æ®
GET /api/lottery-data?latest=true

# è·å–æœ€è¿‘10æœŸæ•°æ®ï¼ˆé»˜è®¤ï¼‰
GET /api/lottery-data

# è·å–æœ€è¿‘20æœŸæ•°æ®
GET /api/lottery-data?limit=20
```

## æ•°æ®æ ¼å¼

### å¼€å¥–æ•°æ®ç»“æ„

```json
{
  "time": "13:40",           // å¼€å¥–æ—¶é—´
  "period": "114046973",     // æœŸå·
  "numbers": "14",           // å¼€å¥–å·ç 
  "timestamp": "2025-08-20T05:43:08.033Z", // æŠ“å–æ—¶é—´æˆ³
  "source": "taiwan_bingo"   // æ•°æ®æ¥æº
}
```

### APIå“åº”æ ¼å¼

```json
{
  "success": true,
  "message": "è·å–æ•°æ®æˆåŠŸ",
  "data": [...],             // å¼€å¥–æ•°æ®æ•°ç»„
  "total": 1,                // æ€»è®°å½•æ•°
  "timestamp": "2025-08-20T05:43:08.033Z"
}
```

## æ–‡ä»¶è¯´æ˜

- `lottery_scraper.js` - æ ¸å¿ƒæŠ“å–è„šæœ¬
- `scheduler.js` - å®šæ—¶è°ƒåº¦å™¨
- `api/lottery-data.js` - APIæ¥å£
- `lottery_data.json` - æ•°æ®å­˜å‚¨æ–‡ä»¶
- `package.json` - é¡¹ç›®é…ç½®å’Œä¾èµ–

## æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œè¦æ±‚**: éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥è®¿é—®å°æ¹¾å®¾æœå®˜ç½‘
2. **æ•°æ®æ›´æ–°**: å¼€å¥–æ•°æ®æ¯5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
3. **å­˜å‚¨é™åˆ¶**: é»˜è®¤ä¿ç•™æœ€è¿‘100æœŸæ•°æ®
4. **æµè§ˆå™¨ä¾èµ–**: ä½¿ç”¨Puppeteeréœ€è¦Chrome/Chromiumæµè§ˆå™¨

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Puppeteerå®‰è£…å¤±è´¥**
   ```bash
   # ä½¿ç”¨å›½å†…é•œåƒ
   npm config set puppeteer_download_host=https://npm.taobao.org/mirrors
   npm install puppeteer
   ```

2. **æŠ“å–å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤ç›®æ ‡ç½‘ç«™å¯è®¿é—®
   - æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

3. **æ•°æ®æ ¼å¼å¼‚å¸¸**
   - ç½‘ç«™ç»“æ„å¯èƒ½å‘ç”Ÿå˜åŒ–
   - éœ€è¦æ›´æ–°è§£æé€»è¾‘

## å¼€å‘è¯´æ˜

### è‡ªå®šä¹‰æŠ“å–é€»è¾‘

å¦‚éœ€ä¿®æ”¹æŠ“å–é€»è¾‘ï¼Œç¼–è¾‘ `lottery_scraper.js` ä¸­çš„ `parseLatestData` æ–¹æ³•ï¼š

```javascript
parseLatestData(text) {
    // åœ¨è¿™é‡Œæ·»åŠ è‡ªå®šä¹‰è§£æé€»è¾‘
    // ...
}
```

### æ‰©å±•APIåŠŸèƒ½

åœ¨ `api/lottery-data.js` ä¸­æ·»åŠ æ–°çš„æ¥å£åŠŸèƒ½ï¼š

```javascript
// æ·»åŠ æ–°çš„æŸ¥è¯¢å‚æ•°å¤„ç†
const { limit, latest, period } = req.query;
```

## è®¸å¯è¯

MIT License